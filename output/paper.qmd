---
title: "toronto_fire_incidents_analysis"
author: "Boxuan Yi"
format: pdf
---

```{r}
library(dplyr)
library(tidyverse)
library(here)
library(janitor)
library(knitr)
library(ggplot2)
```

```{r}
data_cleaned <- read_csv(file = here("../inputs/data/data_cleaned.csv"))
```

```{r}
data_cleaned |>
  group_by(occurrence_month) |>
  summarise(n = n()) |>
  ggplot(mapping = aes(x = occurrence_month, y = n)) +
  geom_line(color = "tomato4") +
  geom_point(color = "black") +
  labs(x = "Occurrence Month", y = "Number of Observations", title = "Monthly Occurrences of Crimes From 2018 to 2023") +
  scale_x_continuous(breaks = 1:12) +  # Set x-axis breaks to show only 1 to 12
  theme_minimal()

```


```{r}
data_cleaned |>
  ggplot(mapping = aes(x = occurrence_year, fill = race_bias)) +
  geom_bar() +
  labs(x = "Year Offence Occurred", y = "Number of Observations", fill = "Race Bias") +
  theme(legend.position = "right") +
  scale_x_continuous(breaks = seq(2018, 2023, by = 1))
```


```{r}
data_cleaned |>
  ggplot(mapping = aes(x = occurrence_year, fill = religion_bias)) +
  geom_bar() +
  labs(x = "Year Offence Occured", y = "Number of Observations", fill = "Religion Bias") +
  theme(legend.position = "right") +
  scale_x_continuous(breaks = seq(2018, 2023, by = 1))
```

```{r}
data_cleaned |>
  ggplot(mapping = aes(x = occurrence_year, fill = location_type)) +
  geom_bar() +
  labs(x = "Year Offence Occured", y = "Number of Observations", fill = "Location Type of the Offence") +
  theme(legend.position = "right") +
  scale_x_continuous(breaks = seq(2018, 2023, by = 1))

data_cleaned |>
  ggplot(mapping = aes(x = division_area, fill = location_type)) +
  geom_bar() +
  labs(x = "Division Area", y = "Number of Observations", fill = "Location Type of the Offence") +
  theme(legend.position = "right") +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))

```


```{r}
data_cleaned |>
  ggplot(mapping = aes(x = location_type, fill = primary_offence_simplified)) +
  geom_bar() +
  labs(x = "Location Type", y = "Number of Observations", fill = "Primary Offence") +
  theme(legend.position = "right") +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))
```

```{r}
data_cleaned |>
  group_by(mental_or_physical_disability) |>
  summarise(count = n()) |>
  rename("Mental or Physical Disability Bias" = mental_or_physical_disability, "Count" = count) |>
  kable()
```

```{r}
data_cleaned |>
  group_by(age_bias) |>
  summarise(count = n()) |>
  rename("Age Bias" = age_bias, "Count" = count) |>
  kable()
```